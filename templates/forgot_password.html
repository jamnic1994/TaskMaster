{% extends 'base.html' %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6">
        <h2 class="text-center">Forgot Password</h2>

        <!-- Form for verifying memorable questions -->
        {% if not verified %}
        <form method="POST">
            <input type="hidden" name="action" value="verify">
            <div class="form-container">
                <div class="mb-3">
                    <label for="email" class="form-label">Email:</label>
                    <input type="email" name="email" class="form-control" required>
                </div>
                <div class="mb-3">
                    <label for="mem_ques1" class="form-label">Memorable Question 1</label>
                    <select name="mem_ques1" id="mem_ques1" class="form-control" required>
                        <option value="" disabled selected>-- Select a question --</option>
                        <option value="What is your favorite color?">What is your favorite color?</option>
                        <option value="What was the name of your first pet?">What was the name of your first pet?</option>
                        <option value="What is the name of your hometown?">What is the name of the city you were born in?</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="mem_ans1" class="form-label">Answer:</label>
                    <input type="text" name="mem_ans1" class="form-control" required>
                </div>
                <div class="mb-3">
                    <label for="mem_ques2" class="form-label">Memorable Question 2</label>
                    <select name="mem_ques2" id="mem_ques2" class="form-control" required>
                        <option value="" disabled selected>-- Select a question --</option>
                        <option value="What is your favorite book?">What is your favorite book?</option>
                        <option value="What was the make and model of your first car?">What was the make and model of your first car?</option>
                        <option value="What is the name of your elementary school?">What is the name of your primary school?</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="mem_ans2" class="form-label">Answer:</label>
                    <input type="text" name="mem_ans2" class="form-control" required>
                </div>
                <button type="submit" class="btn btn-primary w-100">Verify</button>
            </div>
        </form>
        {% else %}
        <p class="text-center text-success">Memorable questions verified! You can now reset your password.</p>
        <button class="btn btn-success w-100" data-bs-toggle="modal" data-bs-target="#resetPasswordModal">Reset Password</button>
        {% endif %}
    </div>
</div>

<!-- Modal for resetting the password -->
<div class="modal fade" id="resetPasswordModal" tabindex="-1" aria-labelledby="resetPasswordModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="resetPasswordModalLabel">Reset Password</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form method="POST">
                    <input type="hidden" name="action" value="reset">
                    <input type="hidden" name="user_id" value="{{ user_id }}">
                    <div class="mb-3">
                        <label for="password" class="form-label">New Password</label>
                        <input type="password" name="password" class="form-control" required>
                    </div>
                    <div class="mb-3">
                        <label for="confirm_password" class="form-label">Confirm Password</label>
                        <input type="password" name="confirm_password" class="form-control" required>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">Reset Password</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
``
